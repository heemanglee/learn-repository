## 1. HTTP(Hypertext Transfer Protocol)

HTTP 프로토콜은 OSI 7 계층(Application 계층)에서 동작한다. HTTP 프로토콜은 웹 통신을 위한 프로토콜로, 클라이언트와 서버 간의 데이터를 주고받기 위해 사용된다. HTTP의 특징은 다음과 같다.

- 클라이언트-서버 구조 : 요청을 보내는 클라이언트와 응답을 보내는 서버 구조이다. 클라이언트가 요청을 보내지 않는다면, 서버는 클라이언트로 메시지를 전달할 수 없다.
- 비연결형(Connectionless) : 요청에 대한 응답이 내려졌을 때 클라이언트와 서버는 연결을 끊는다.
- 비상태성(stateless) : 서버는 클라이언트의 이전 요청에 대해서 저장하지 않는다.
- HTTP는 80 포트를 사용하여 통신한다.
<br />

HTTP 프로토콜은 TCP 위에서 데이터를 주고받는다. TCP는 연결지향 프로토콜로써 3-way handshake를 통해 신뢰할 수 있는 TCP 세션을 맺는다. HTTP는 이 TCP 세션 위에서 클라이언트와 서버가 요청과 응답을 주고받는다. HTTP 자체는 연결 지향 프로토콜이 아니지만, TCP 위에서 동작하기 때문에 TCP 특성을 활용하여 신뢰성을 제공한다.

## 2. HTTPS(Hypertext Transfer Protocol Secure)

HTTPS는 기본적으로 HTTP 구조를 따르되, 보안 계층이 추가된다. HTTP의 문제점은 클라이언트와 서버가 메시지를 주고받을 때 평문을 전달하기 때문에 네트워크 중간에서 스니핑이 발생할 수 있다. 이 문제를 해결하기 위해 SSL/TLS 프로토콜을 추가하여 평문을 암호화하여 전달한다. 

<br />

SSL/TLS 프로토콜의 특징은 다음과 같다.
- 데이터 암호화 : 요청/응답에 담기는 메시지를 암호화한다.
- 데이터 무결성 : 데이터가 전송 중에 변조되지 않았음을 보장한다.
- 서버 인증 : 클라이언트가 신뢰할 수 있는 서버와 통신하고 있음을 보장한다.

<br />

SSL/TLS 프로토콜은 응용 계층~전송 계층 사이에서 독립적인 프로토콜 계층을 만들어서 동작한다. 응용 계층에서 실행되는 애플리케이션은 TCP 계층으로 메시지를 전달하지 않고 SSL/TLS 계층으로 전송한다. SSL/TLS 계층은 받은 메시지를 암호화하여 TCP 계층으로 전송한다. 
즉, SSL/TLS는 애플리케이션 계층(HTTP)과 전송 계층(TCP) 사이에서 보안 계층으로 동작한다.

<br />

클라이언트와 서버가 HTTPS 위에서 메시지를 주고받기 위해서는 서버 측에서 SSL/TLS 인증서를 발급받아야 한다. 이 인증서는 CA(인증 기관, Certificate Authority)에서 발급한다. CA로부터 SSL/TLS 인증서를 발급받는 과정은 다음과 같다.
1. 서버는 CA에게 CSR를 전송한다. 
    1. CSR에는 서버의 도메인, 서버의 공개키 등이 포함된다.
2. CA는 도메인 주소가 서버의 소유인지 검증한다.
3. CA는 CSR 정보를 바탕으로 인증서를 발급한다.
    1. 인증서에는 발급 대상, 서버의 공개키, 서버의 지문, 발급자, 발급자의 서명 등이 포함된다.
    2. 지문 : 서버의 공개키를 해시 알고리즘으로 암호화하여 얻은 해시 값
    3. 서명 : 생성된 지문에 CA의 개인키로 암호화한 것
4. CA가 발급한 SSL/TLS 인증서는 서버로 전송된다.
CA가 서버의 도메인에 SSL/TLS 인증서를 발급했다는 것은 신뢰할 수 있는 사이트임을 인증하는 것이다.

<br />

클라이언트는 서버와 HTTPS 통신을 하기 위해 서버의 SSL/TLS 인증서가 신뢰할 수 있는지 확인한다. 서버가 클라이언트로 인증서를 제공하면 클라이언트는 이 인증서가 위조되었는지 검증한다. 위조되지 않은 SSL/TLS 인증서라면 브라우저는 서버를 신뢰할 수 있게 된다.
1. 클라이언트는 서버의 SSL/TLS 인증서를 받는다.
2. 클라이언트는 CA의 공개키를 사용하여 서명을 복호화한다.
3. 클라이언트는 인증서가 위조되지 않았는지 확인한다.
    1. 인증서 유효 기간 확인
    2. 인증서의 발급자가 신뢰할 수 있는 CA인지 확인
4. 인증서의 도메인이 클라이언트가 접속하는 도메인과 일치하는지 확인한다.

<br />

클라이언트가 서버의 SSL/TLS 인증서를 신뢰할 수 있는 상태가 된다면 HTTPS 통신이 가능한 상태가 된다. HTTPS 통신은 요청과 응답에 담긴 메시지를 암호화하기 때문에 암호화에 사용할 키가 필요하다. 일반적으로 암호화 속도가 빠른 대칭키를 사용하여 클라이언트와 서버가 메시지를 암호화한다. 

클라이언트는 메시지 암호화에 사용할 대칭키를 생성하여 서버로 전송해야 한다. 그러나 클라이언트의 대칭키를 서버에 그대로 전송한다면 중간자 공격에 노출될 가능성이 존재한다. 따라서 서버의 공개키를 사용하여 암호화한 후 전송한다. 서버는 자신의 개인키로 복호화하여 대칭키를 얻는다.
